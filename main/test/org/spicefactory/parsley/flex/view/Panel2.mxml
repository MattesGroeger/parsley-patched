<mx:Panel 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:parsley="org.spicefactory.parsley.flex.tag.view.*"
	xmlns:view="org.spicefactory.parsley.flex.view.*"
	xmlns:custom="org.spicefactory.parsley.flex.view.tag.*"
	width="100%"
	height="100%"
	title="Panel2"
	horizontalScrollPolicy="off"
	addedToStage="trace('ADD 2');"
	>
	
	<mx:Script>
		<![CDATA[
			 import mx.controls.Alert;
			 import org.spicefactory.parsley.core.context.ContextUtil;
			 import org.spicefactory.parsley.testmodel.AnnotatedResourceBinding;
			 import flash.events.Event;
			 import org.spicefactory.parsley.flex.mxmlconfig.core.CoreModel;
	         import org.spicefactory.parsley.flex.FlexContextBuilder;
	         import org.spicefactory.parsley.core.context.Context;
	         import mx.containers.Panel;
	         import mx.managers.PopUpManager;
	         import mx.containers.TitleWindow;
			
			 [Bindable]
			 public var model:CoreModel;	
			 
			[Bindable]
			public var model2:CoreModel;
			
			[Bindable]
			public var model3:CoreModel;
         
         	 //[Inject]
         	 public var context:Context;
         	
         	 private var window:TitleWindow;
         	 
         	 
         	 public var resourceBinding:AnnotatedResourceBinding;
         
         
     		private function testContextLookup () : void {
     			ContextUtil.findContextInView(this, contextFound);
     		}
     		
     		private function contextFound (context:Context) : void {
     			Alert.show("Context: " + context);
     		}
         
	         private function showPopup () : void {
	         	if (window == null) window = new SomeWindow();
	         	context.viewManager.addViewRoot(window);
	         	PopUpManager.addPopUp(window, this);
	         }
	         
	         private function hidePopup () : void {
	         	PopUpManager.removePopUp(window);
	         }
     		
      ]]>
   </mx:Script>
   
	
	<!--<parsley:ConfigureTag configId="panel2"/>-->
	
	<!--
	<parsley:FastInjectTag objectId="object" property="model2"/>
	<parsley:FastInjectTag type="{CoreModel}" property="model3"/>
	-->
	
	<parsley:FastInjectTag
		injectionComplete="trace('+++ injectionComplete');"
		creationComplete="trace('+++ creationComplete');"
		addedToStage="trace('+++ addedToStage');"
		removedFromStage="trace('+++ removedFromStage');"
		>
		<parsley:InjectTag objectId="object" property="model2"/>
		<parsley:InjectTag type="{CoreModel}" property="model3"/>
		<parsley:InjectTag type="{Context}" property="context"/>
	</parsley:FastInjectTag>
	
	<custom:AlternativeFastInject type="{AnnotatedResourceBinding}" property="resourceBinding"/>
	
	<mx:Text text="AA2"/>
	<mx:Text text="Bound value: |{model.stringProp}|"/>
	<mx:Text text="BB2"/>
	
	<mx:Text text="Fast Inject value (id): |{model2.stringProp}|"/>
	<mx:Text text="Fast Inject value (type): |{model3.stringProp}|"/>

	<mx:Button label="Show Popup" click="showPopup();"/>

	<mx:Button label="Hide Popup" click="hidePopup();"/>

	<mx:Button label="Test Context Lookup" click="testContextLookup();"/>
	
	<view:NestedCanvas width="80%" left="20"/>

	
</mx:Panel> 